### 0. HOST 회원가입
POST http://localhost:8080/api/v1/auth/signup
Content-Type: application/json

{
  "email": "test@example.com",
  "password": "Test1234!@#",
  "nickName": "Beemo"
}

> {%
  client.global.set("hostUserId", response.body.data.userId);
%}


### 0-1. HOST 로그인
POST http://localhost:8080/api/v1/auth/login
Content-Type: application/json

{
  "email": "test@example.com",
  "password": "Test1234!@#"
}

> {%
  client.global.set("hostAccessToken", response.body.data.accessToken);
%}


### 0-2. FOLLOWER 회원가입
POST http://localhost:8080/api/v1/auth/signup
Content-Type: application/json

{
  "email": "follower@example.com",
  "password": "Test1234!@#",
  "nickName": "Jake"
}

> {%
  client.global.set("followerUserId", response.body.data.userId);
%}


### 0-3. FOLLOWER 로그인
POST http://localhost:8080/api/v1/auth/login
Content-Type: application/json

{
  "email": "follower@example.com",
  "password": "Test1234!@#"
}

> {%
  client.global.set("followerAccessToken", response.body.data.accessToken);
%}


### 0-4. FOLLOWER 알림 허용 (켜기)
PATCH http://localhost:8080/api/v1/users/notification?isNotificationEnabled=true
Authorization: Bearer {{followerAccessToken}}


### 0-5. FOLLOWER -> HOST 팔로우
POST http://localhost:8080/api/v1/users/follow?followNickname=Beemo
Authorization: Bearer {{followerAccessToken}}


### 0-6. (교차검증) 모임 생성 전 FOLLOWER unread-count
GET http://localhost:8080/api/v1/notifications/unread-count
Authorization: Bearer {{followerAccessToken}}

> {%
    client.global.set("SSE_URL_HEADER", "http://localhost:8080/api/v1/notifications/subscribe");
    client.global.set("SSE_URL_QUERY", "http://localhost:8080/api/v1/notifications/subscribe?accessToken=" + client.global.get("followerAccessToken"));
%}


### 1-1. FOLLOWER SSE 구독 (헤더 방식)
GET {{SSE_URL_HEADER}}
Authorization: Bearer {{followerAccessToken}}
Accept: text/event-stream
Cache-Control: no-cache
Connection: keep-alive



### 1-2. FOLLOWER SSE 구독 (QueryParam 방식 - 서버가 이 방식을 지원할 때만)
### - 위 1-1이 안 될 때만 이걸로 테스트하세요.
GET {{SSE_URL_QUERY}}
Accept: text/event-stream
Cache-Control: no-cache
Connection: keep-alive

### HOST SSE 구독 추가
GET http://localhost:8080/api/v1/notifications/subscribe
Authorization: Bearer {{hostAccessToken}}
Accept: text/event-stream
Cache-Control: no-cache
Connection: keep-alive


### 2-1. 모임 V2 이미지 선 업로드 (png/jpg 2장) - HOST
POST http://localhost:8080/api/v2/groups/images/upload
Content-Type: multipart/form-data; boundary=boundary
Authorization: Bearer {{hostAccessToken}}

--boundary
Content-Disposition: form-data; name="images"; filename="img1.png"
Content-Type: image/png

< ../../image/resources/img1.png
--boundary
Content-Disposition: form-data; name="images"; filename="img4.jpg"
Content-Type: image/jpeg

< ../../image/resources/img4.jpg
--boundary--

> {%
  const images = response.body.data.images;
  client.global.set("img0_key", images[0].imageKey);
  client.global.set("img1_key", images[1].imageKey);
%}



### 2-2. HOST 모임 생성 (이 순간 SSE 이벤트가 FOLLOWER에 와야 함)
POST http://localhost:8080/api/v2/groups/create
Content-Type: application/json
Authorization: Bearer {{hostAccessToken}}

{
  "title": "SSE 알림 실시간 테스트",
  "location": "서울 강남구",
  "joinPolicy": "FREE",
  "locationDetail": "강남역 2번 출구 근처 카페",
  "startTime": "2026-12-10T19:00:00",
  "endTime": "2026-12-10T21:00:00",
  "tags": ["자바","백엔드","스터디"],
  "description": "SSE 구독 후 모임 생성 시 follower에게 이벤트가 실시간으로 와야 합니다.",
  "maxParticipants": 12,
  "images": [
    { "sortOrder": 0, "imageKey": "{{img0_key}}" },
    { "sortOrder": 1, "imageKey": "{{img1_key}}" }
  ]
}

> {%
  client.global.set("createdGroupId", response.body.data.id);
%}



### 3-1. 모임 생성 후 FOLLOWER unread-count (DB 기준으로도 증가했는지)
GET http://localhost:8080/api/v1/notifications/unread-count
Authorization: Bearer {{followerAccessToken}}



### 3-2. FOLLOWER 알림 목록 조회 (목록에도 쌓였는지)
GET http://localhost:8080/api/v1/notifications
Authorization: Bearer {{followerAccessToken}}

### 4. FOLLOWER 모임 참여(Join) 또는 승인까지 완료
POST http://localhost:8080/api/v2/groups/{{createdGroupId}}/attend
Authorization: Bearer {{followerAccessToken}}
Content-Type: application/json

{}

### 5. FOLLOWER 모임 탈퇴
POST http://localhost:8080/api/v2/groups/{{createdGroupId}}/left
Authorization: Bearer {{followerAccessToken}}


### 6. 탈퇴 후 HOST unread-count (DB 기준 검증)
GET http://localhost:8080/api/v1/notifications/unread-count
Authorization: Bearer {{hostAccessToken}}


### 7. 탈퇴 후 HOST 알림 목록 조회
GET http://localhost:8080/api/v1/notifications
Authorization: Bearer {{hostAccessToken}}
